{% extends "admin.html" %}

{% block headBlock %}
    <title>{{ teams[0].name }} vs {{ teams[1].name }}</title>
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/style_game.css') }}">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/style_admin.css') }}">
{% endblock %}

{% block bodyBlock %}

    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/style_game.css') }}">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/style_admin.css') }}">
    <link rel="shortcut icon" href="{{ url_for('static', filename='favicon.ico') }}">

    <script src="{{ url_for('static', filename='js/admin.js') }}"></script>
    <script>setTournament("{{tournament}}")</script>
    <script>setId("{{game.id}}")</script>
    <div class="row">

        <div class="col-sm-9">

            <h1><a href="/games/{{ game.id }}/admin" class="hide">{{ teams[0].name }}
                vs {{ teams[1].name }}</a></h1>
            <h1 class="big"><a class="hide"
                               href="/games/{{ game.id }}/display">{{ game.score_string }}</a>
            </h1>
            <p><b>Round:</b> <a class="hide"
                                href="/{{ tournamentLink }}fixtures/admin?round={{ game.round }}"><i>{{ game.round }}</i></a>
            </p>
            <p><b>Court:</b> <a class="hide"
                                href="/{{ tournamentLink }}fixtures/admin?court={{ game.court }}"><i>{{ game.courtName }}</i></a>
            </p>
            <p><b>Match Official:</b>{% if not game.bye %}
                <a class="hide" href="/{{ tournamentLink }}officials/{{ game.umpireSearchableName }}">{% endif %}
                <i>{{ game.umpire }}</i>
                {% if not game.bye %}</a> {% endif %}</p>
            {% if game.scorer %}
                <p><b>Match Scorer:</b>
                    <a class="hide" href="/{{ tournamentLink }}officials/{{ game.scorerSearchableName }}">
                        <i>{{ game.scorer }}</i>
                    </a></p>
            {% endif %}
            {% if game.startTime > 0 %}
                <p><b>Match Time:</b> <i>{{ game.startTimeStr }}</i></p>
                <p><b>Match Length:</b> <i>{{ game.length }}</i></p>
            {% endif %}
            <p>{% if not game.bye %}<a href="/games/{{ game.id }}/edit" class="hide">{% endif %}<b>Status:</b>
                {% if not game.bye %}</a>{% endif %} <i>{{ game.status }}</i></p>

            {% if game.best_player %}
                <p><b>Best on Court:</b> <a class="hide"
                                            href="/{{ tournamentLink }}players/{{ game.bestSearchableName }}/admin"><i>{{ best }}</i></a>
                </p>
            {% endif %}
            <br>
            <table class="jaredTable">
                <tr>
                    <th></th>
                    <th colspan="{{ teams[0].players.__len__() }}"><a
                            href="/{{ tournamentLink }}teams/{{ teams[0].searchableName }}/admin"
                            class="hide"><img
                            src="{{ teams[0].image }}"
                            class="team_logo"
                            style="display: inline;left:70%;vertical-align:middle;"></a></th>
                    <th colspan="{{ teams[1].players.__len__() }}">
                        {% if not game.bye %}<a href="/{{ tournamentLink }}teams/{{ teams[1].searchableName }}/admin"
                                                class="hide">{% endif %}<img
                            src="{{ teams[1].image }}"
                            class="team_logo"
                            style="display: inline;left:70%;vertical-align:middle;">{% if not game.bye %}</a>{% endif %}
                    </th>
                </tr>

                <tr>
                    <td></td>
                    <th style="min-width: 150px" colspan="{{ teams[0].players.__len__() }}"><b><a
                            href="/{{ tournamentLink }}teams/{{ teams[0].searchableName }}/admin"
                            class="hide">{{ teams[0].name }}</a></b></th>
                    <th style="min-width: 150px" colspan="{{ teams[1].players.__len__() }}"><b>{% if not game.bye %}
                        <a href="/{{ tournamentLink }}teams/{{ teams[1].searchableName }}/admin"
                           class="hide">{% endif %}{{ teams[1].name }}{% if not game.bye %}
                        </a>{% endif %}</b></th>
                    <th class="invisible">Spacerrrrrrr</th>
                </tr>
                {% for i in team_headings %}
                    <tr>
                        <th>{{ i }}:</th>
                        <td colspan="{{ teams[0].players.__len__() }}">{{ teams[0].stats[i] }}</td>
                        <td colspan="{{ teams[1].players.__len__() }}">{{ teams[1].stats[i] }}</td>
                    </tr>


                {% endfor %}
                <tr>
                    <td></td>
                    {% for i in game.players %}
                        <th><b><a class = "hide" href="/{{ tournamentLink }}/players/{{ i.searchableName }}/admin">{{ i.name }}</a></b></th>
                    {% endfor %}
                </tr>
                {% for i in player_headings %}
                    <tr>
                        <th>{{ i }}:</th>
                        {% for j in game.players %}
                            <td>{{ j.stats[i] }}</td>
                        {% endfor %}
                    </tr>
                {% endfor %}
            </table>
        </div>
        <div class="col-sm-3">
            <div style="min-height: 150px">
                <h2>Notes</h2>
                <br>
                {% if not game.notes.strip() %}
                    <i>No notes were left for this game</i>
                {% else %}
                    {{ game.notes }}
                {% endif %}
            </div>
            <div style="min-height: 150px">
                <h2>Cards</h2>
                <br>
                {% if not game.cards %}
                    <i>No cards were awarded in this game</i>
                {% endif %}
                {% for i in game.cards %}
                    <i>{{ i.player }} has received a <a style="color: {{ i.hex }}">{{ i.type }}</a> card
                        for</i> <b>{{ i.reason }}</b>
                    <br>
                    <br>
                {% endfor %}
            </div>
            <div style="min-height: 150px">
                <h2>Protests</h2>
                <br>
                {% if game.protested == 3 %}
                    <b>Both Teams</b><i> have protested!</i>
                {% elif not game.protested %}
                    <i>No Teams have protested</i>
                {% else %}
                    <b>{{ game.teams[game.protested - 1] }}</b><i> have protested!</i>
                {% endif %}
            </div>
            <div style="min-height: 150px">
                <h2>Resolve</h2>
                <br>
                {% if not game.status not in ['Official', 'Resolved']  %}
                    <i>This game does not need resolution</i>
                {% else %}
                    <button onclick="resolveGame()" class="button">Resolve</button>
                {% endif %}
                <br>
            </div>
            <div style="min-height: 100px">
                <h2>Commentary</h2>
                {% for line in commentary %}
                    <p style="color: black;">{{ line }}</p>
                {% endfor %}
            </div>
        </div>
    </div>
{% endblock %}